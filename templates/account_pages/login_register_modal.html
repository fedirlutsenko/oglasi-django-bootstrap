{% load static %}

{% block page_specific_styles %}
{% endblock %}

<i class="bi bi-person ms-2 me-1 hover {% if request.path == '/' %} text-white {% else %} menu-user-icon-dark {% endif %} rounded-circle menu-user-icon"></i>
<a class="nav-link pe-0 hover ps-1 d-flex align-items-center justify-content-center {% if request.path == '/' %} nav-hover text-white {% endif %} hovers"  data-bs-toggle="modal" data-bs-target="#accountModal" onclick="signInModal()">
  Prijava
</a>
  <div class="modal fade" id="accountModal" tabindex="-1" aria-labelledby="loginModal" aria-hidden="true">
    <div class="modal-dialog" style="max-width: 512px!important;">
      <div class="modal-content">
        <div class="modal-body" style="padding: 12px 24px 4px 24px;">
          <div class="tab-content" id="myTabContents">
            <!--SING IN MODAL-->
            <div class="d-flex justify-content-end">
              {% include 'includes/alerts.html' %}
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="tab-pane fade show active" id="signin" role="tabpanel" aria-labelledby="signin-tab">
              <div class=" w-100 d-flex flex-column align-items-center">
                <form action="{% url 'login' %}" method="post" class="needs-validation" novalidate>
                  {% csrf_token %}
                    <h2 class="mb-4 fw-bold text-center" style="font-size: 24px;">Ulogujte se</h2>
                  <div>
                    <label for="email" class="form-label mb-1" style="font-weight: 600">Email *</label>
                    <input type="email" class="form-control height-40px" style="margin-bottom: 36px;width: 320px" id="email" name="email" aria-describedby="emailHelp" required>
                  </div>
                  <div>
                    <label for="floatingPassword" class="form-label mb-1" style="font-weight: 600">Lozinka *</label>
                    <input type="email" class="form-control height-40px" style="margin-bottom: 56px;width: 320px;" id="floatingPassword" name="password" aria-describedby="passwordHelp" required>
                  </div>
                  <div class="form-floating d-flex justify-content-center" style="margin-bottom: 32px;">
                    <button class="btn btn-lg btn-primary text-white" type="submit" style="width: 320px; height: 48px;font-weight: 700;font-size: 16px;">Ulogujte se</button>
                  </div>
                </form>
              </div>
            </div>
            <!--REGISTER MODAL-->
            <div class="tab-pane fade" id="register" role="tabpanel" aria-labelledby="register-tab">
              <div class=" w-100" >
                <form action="{% url 'register' %}" method="POST">
                  {% csrf_token %}
                  <h2 class="fw-bold text-center" style="margin-bottom: 18px;font-size: 24px;">Registracija</h2>
                  <nav class="mb-4">
                    <div class="nav  d-flex align-items-center justify-content-between" id="nav-tab" role="tablist">
                      <div class="form-check ps-0">
                        <input class="form-check-input m-0" type="checkbox" style="width: 24px;height: 24px;" id="nav-user-tab" data-bs-toggle="tab" data-bs-target="#nav-user" type="checkbox" role="tab" aria-controls="nav-user" aria-selected="true">
                        <label class="form-check-label ms-3" for="nav-user-tab">
                          Fizičko lice
                        </label>
                      </div>
                      <div class="form-check ">
                        <input class="form-check-input m-0" type="checkbox" style="width: 24px;height: 24px;" id="nav-agency-tab" data-bs-toggle="tab" data-bs-target="#nav-agency" type="checkbox" role="tab" aria-controls="nav-agency" aria-selected="false">
                        <label class="form-check-label ms-3" for="nav-agency-tab">
                          Pravno lice 
                        </label>
                      </div>
                    </div>
                  </nav>
                  <div class="tab-content" id="nav-tabContent">
                    <div class="tab-pane fade show active" id="nav-user" role="tabpanel" aria-labelledby="nav-user-tab" tabindex="0">
                      <div class="row mb-3">
                        <div class="col-6 " style="padding: 0px 28px 0px 0px!important;">
                          <label for="floatingfirstname" class="form-label mb-1" style="font-weight: 600">Ime</label>
                          <input type="text" class="form-control height-40px" style="margin-bottom: 16px;width: 200px" id="floatingfirstname" name="first_name" aria-describedby="passwordHelp" required>
                        </div>
                        <div class="col-6" style="padding: 0px 0px 0px 28px!important;">
                          <label for="floatinglastname" class="form-label mb-1" style="font-weight: 600">Prezime</label>
                          <input type="text" class="form-control height-40px" style="margin-bottom: 16px;width: 200px" id="floatinglastname" name="last_name" aria-describedby="passwordHelp" required>
                        </div>
                        <div class="col-6 ps-0" style="padding: 0px 28px 0px 0px!important;">
                          <label for="floatingusername" class="form-label mb-1" style="font-weight: 600">Korisničko ime *</label>
                          <input type="text" class="form-control height-40px" style="margin-bottom: 16px;width: 200px" id="floatingusername" name="user_name" aria-describedby="passwordHelp" required>
                        </div>
                        <div class="col-6 pe-0" style="padding: 0px 0px 0px 28px!important;">
                          <label for="floatingregisteremail" class="form-label mb-1" style="font-weight: 600">Email *</label>
                          <input type="email" class="form-control height-40px" style="margin-bottom: 16px;width: 200px" id="floatingregisteremail" name="email" aria-describedby="emailHelp" required>
                        </div>
                        <div class="col-6 ps-0" style="padding: 0px 28px 0px 0px!important;">
                          <label for="floatingpassword" class="form-label mb-1" style="font-weight: 600">Lozinka *</label>
                          <input type="password" class="form-control height-40px" style="width: 200px" id="floatingpassword" name="password" aria-describedby="passwordHelp" required>
                        </div>
                        <div class="col-6 pe-0  " style="padding: 0px 0px 0px 28px!important;">
                          <label for="floatingconfirmpassword" class="form-label mb-1" style="font-weight: 600">Potvri lozinku *</label>
                          <input type="password" class="form-control height-40px" style="width: 200px" id="floatingconfirmpassword" name="confirm_password" aria-describedby="passwordHelp" required>
                        </div>
                      </div>
                    </div>
                    <div class="tab-pane fade" id="nav-agency" role="tabpanel" aria-labelledby="nav-agency-tab" tabindex="0">...</div>
                  </div>
                  <div class="d-flex flex-column" style="padding-left: 72px;margin-bottom: 32px;">
                    <div class="form-check"> 
                      <input class="form-check-input" type="checkbox"  id="nav-user-tab" data-bs-toggle="tab" data-bs-target="#nav-user" type="checkbox" role="tab" aria-controls="nav-user" aria-selected="true">
                      <label class="form-check-label font-weight-600 font-size-12px" for="nav-user-tab" style="margin-left: 4px;">
                        Prihvatam pravila i uslove korišćenja portama Moj Dom
                      </label>
                    </div>
                    <div class="form-check">
                      <input class="form-check-input" type="checkbox"  id="nav-user-tab" data-bs-toggle="tab" data-bs-target="#nav-user" type="checkbox" role="tab" aria-controls="nav-user" aria-selected="true">
                      <label class="form-check-label font-weight-600 font-size-12px"  for="nav-user-tab" style="margin-left: 4px;">
                        Želim da primam obavještenja
                      </label>
                    </div>
                    <div class="form-check">
                      <input class="form-check-input" type="checkbox"  id="nav-user-tab" data-bs-toggle="tab" data-bs-target="#nav-user" type="checkbox" role="tab" aria-controls="nav-user" aria-selected="true">
                      <label class="form-check-label font-weight-600 font-size-12px" for="nav-user-tab" style="margin-left: 4px;">
                        Biće saglasnosti za račune kasnije, samo uračunavam prostor
                      </label>
                    </div>
                  </div>
                  <div class="form-floating d-flex justify-content-center" style="margin-bottom: 32px;">
                    <button class="btn btn-lg btn-primary text-white" style="width: 320px;height: 48px;font-weight: 700;font-size: 16px;" type="submit">Register</button>
                  </div>
                  <!-- {{ form.email.errors|add:"Please enter a valid email address. " }}
                  {{ form.password.errors|add:"Enter password correctly" }}
                  {{ form.confirm_password.errors }}
                  {{ form.non_field_errors }} -->
                </form>
              </div>
            </div>
            <!--FORGOT PASSWORD MODAL-->
            <div class="tab-pane fade" id="forgotpassword" role="tabpanel" aria-labelledby="forgotpassword-tab">
              <div class=" form-signin w-100 m-auto">
                <form action="{% url 'forgot_password' %}" method="post">
                  {% csrf_token %}
                  <h2 class="mb-4 fw-bold text-center" style="font-size: 24px;">Forgot password?</h2>
                  <div>
                    <label for="forgot-password-label" class="form-label mb-1" style="font-weight: 600">Email *</label>
                    <input type="email" class="form-control height-40px" style="margin-bottom: 36px;width: 320px" id="forgot-password-label" name="email" aria-describedby="emailHelp" required>
                  </div>
                  <div class="form-floating mb-3">
                    <button class="btn btn-lg btn-primary text-white" style="width: 320px;height: 48px;font-weight: 700;font-size: 16px;">Pošalji</button>
                  </div>
                </form>
              </div>
            </div>
            <div class="form-floating">
              <ul class="d-flex flex-column align-items-center p-0 font-weight-600 font-size-12px"  id="myTabas" role="tablist">
                <div id="log_in" style="display: none;margin-bottom: 12px;">Već ste registrovani?
                  <a style="text-decoration: none;" class="active text-primary font-weight-600 font-size-12px"  id="signin-tab" data-bs-toggle="tab" data-bs-target="#signin" type="button" role="tab" aria-controls="signin" aria-selected="true"  onclick="singin()">Ulogujte se</a>
                </div>
                <div id="dont_have_acc" class="font-weight-600 font-size-12px">Nemate nalog?
                  <a style="text-decoration: none;margin-bottom: 12px;" class="text-primary font-weight-600 font-size-12px" id="register-tab" data-bs-toggle="tab" data-bs-target="#register" type="button" role="tab" aria-controls="register" aria-selected="false"  onclick="register()">Registruj se</a>
                </div>
                <div id="forgot_pass" class="font-weight-600 font-size-12px">
                  <a style="text-decoration: none;margin-bottom: 12px;" class="text-primary font-weight-600 font-size-12px" id="forgotpassword-tab" data-bs-toggle="tab" data-bs-target="#forgotpassword" type="button" role="tab" aria-controls="forgotpassword" aria-selected="false" onclick="forgotpassword()">Zaboravili ste lozinku?</a>
                </div>
              </ul>
            </div> 
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary text-white" data-bs-dismiss="modal">Otkaži</button>
        </div>
      </div>
    </div>
  </div>
  <div class="{% if request.path == '/' %} text-white {% endif %}">&nbsp;  / &nbsp; </div>
  <a class="ps-0 nav-link  {% if request.path == '/' %} nav-hover  text-white {% endif %}" data-bs-toggle="modal" data-bs-target="#accountModal" onclick="registerModal()">Registracija</a>

<script>

function singin() {
  document.getElementById('dont_have_acc').setAttribute('style', 'display: block;')
  document.getElementById('forgot_pass').setAttribute('style', 'display: block;')
  document.getElementById('log_in').setAttribute('style', 'display: none;')
}
function register() {
  document.getElementById('dont_have_acc').setAttribute('style', 'display: none;')
  document.getElementById('forgot_pass').setAttribute('style', 'display: block;')
  document.getElementById('log_in').setAttribute('style', 'display: block;')
}

function forgotpassword() {
  document.getElementById('dont_have_acc').setAttribute('style', 'display: block;')
  document.getElementById('forgot_pass').setAttribute('style', 'display: none;')
  document.getElementById('log_in').setAttribute('style', 'display: block;')
}

function registerModal() {
  document.getElementById('register-tab').click()
}
function signInModal() {
  document.getElementById('signin-tab').click()
}

function agencyModal(show) {
  console.log(show)
  if (show === 'agency') {
    document.getElementById('agencyPart').setAttribute('style', 'display: block;')
    document.getElementById('floatingPIB').setAttribute('required', true);
  } else if (show === 'fizicko-lice') {
    document.getElementById('agencyPart').setAttribute('style', 'display: none;')
    document.getElementById('floatingPIB').setAttribute('required', false);

  }
}
</script>