{% load static %}
<div class="og-container-40 {% if request.path == '/'%} center-absolute-header w-100 {% else %}  {% endif %}"  style="z-index: 5;height: 56px;">
  <div class="row m-0 header align-items-center non-printable-area">
    <div class="col-2 p-0 d-flex justify-content-start">
      <a href="{% url 'home' %}"> 
        <img class="logo" style="margin-left: -11px;" src="{% static 'images/shared/logos.svg' %}" height="56px" alt="logo">
      </a>
    </div>
    <div class="col-8 d-flex flex-wrap align-items-center justify-content-center">
      <ul class="nav">
        <li class="px-2 ">
          <a href="#" class="nav-link nav-hover px-2 {% if request.path == '/oglasi/' %} link-secondary {% elif request.path == '/' %} text-white {% endif %}" data-bs-toggle="dropdown" aria-expanded="false">
            Nekretnine
          </a>
          <ul class="dropdown-menu" id="subCategories">
            
          </ul>
        </li>
        <li class="px-2 ">
          <a href="#" class="nav-link nav-hover px-2 {% if request.resolver_match.url_name == 'new_builds'  %} link-secondary {% elif request.resolver_match.url_name == 'home' %} text-white {% endif %}" data-bs-toggle="dropdown" aria-expanded="false">
            Novogradnja
          </a>
          <ul class="dropdown-menu">
            <li>
              <a href="#" class="font-weight-600 nav-link nav-hover py-1 px-2 {% if request.resolver_match.url_name == 'project_list' %} link-secondary {% endif %}">Projekti</a>
            </li>
            <li>
              <a href="{% url 'new_builds' %}" class="font-weight-600 nav-link nav-hover py-1 px-2 {% if request.resolver_match.url_name == 'new_builds' %} link-secondary {% endif %}">Novogradnja</a>
            </li>
          </ul>
        </li>
        <li class="px-2 ">
          <a href="#" class="nav-link nav-hover px-2 {% if request.resolver_match.url_name == 'news_list' or request.resolver_match.url_name == 'blog_list'  %} link-secondary  {% elif request.resolver_match.url_name == 'home' %} text-white  {% endif %}" data-bs-toggle="dropdown" aria-expanded="false">
            Vesti
          </a>
          <ul class="dropdown-menu">
            <li>
              <a href="{% url 'news_list' %}" class="font-weight-600 nav-link nav-hover py-1 px-2 {% if request.resolver_match.url_name == 'news_list' %} link-secondary {% endif %}">Vesti</a>
            </li>
            <li>
              <a href="{% url 'blog_list' %}" class="font-weight-600 nav-link nav-hover py-1 px-2 {% if request.resolver_match.url_name == 'blog_list' %} link-secondary {% endif %}">Blog</a>
            </li>
          </ul>
        </li>
        <li class="px-2 ">
          <a href="#" class="nav-link nav-hover px-2 {% if request.resolver_match.url_name == 'investors_page' or request.resolver_match.url_name == 'agencies_page' %} link-secondary {% elif request.resolver_match.url_name == 'home' %} text-white {% endif %}" data-bs-toggle="dropdown" aria-expanded="false">
            Oglašavanje
          </a>
          <ul class="dropdown-menu">
            <li>
              <a href="{% url 'agencies_page' %}" class="font-weight-600 nav-link nav-hover py-1 px-2 {% if request.resolver_match.url_name == 'agencies_page' %} link-secondary {% endif %}">Agencije</a>
            </li>
            <li>
              <a href="{% url 'investors_page' %}" class="font-weight-600 nav-link nav-hover py-1 px-2 {% if request.resolver_match.url_name == 'investors_page' %} link-secondary {% endif %}">Investitori</a>
            </li>
            <li>
              <a href="#" class="font-weight-600 nav-link nav-hover py-1 px-2 {% if request.path == '###pravna lica###' %} link-secondary {% endif %}">Pravna lica</a>
            </li>
            <li>
              <a href="#" class="font-weight-600 nav-link nav-hover py-1 px-2 {% if request.path == '###banke###' %} link-secondary {% endif %}">Banke</a>
            </li>
          </ul>
        </li>
        <li class="px-2 "><a href="#" class="nav-link nav-hover px-2  {% if request.path == '###drugi oglasi###' %} link-secondary {% elif request.resolver_match.url_name == 'home' %} text-white  {% endif %}">Drugi oglasi</a></li>
        <li class="px-2 ">
          <a href="#" class="nav-link nav-hover px-2 {% if request.path == 'TODO: DEFINE' %} link-secondary {% elif request.resolver_match.url_name == 'home' %} text-white {% endif %}" data-bs-toggle="dropdown" aria-expanded="false">
            Info
          </a>
          <ul class="dropdown-menu">
            <li>
              <a href="#" class="font-weight-600 nav-link nav-hover py-1 px-2 {% if request.path == '/oglasi/' %} link-secondary {% endif %}">Cenovnik</a>
            </li>
            <li>
              <a href="{% url 'about_us' %}?selected=kontakt" class="font-weight-600 nav-link nav-hover py-1 px-2 {% if request.path == '/oglasi/' %} link-secondary {% endif %}">Kontakt</a>
            </li>
            <li>
              <a href="{% url 'about_us' %}?selected=onama" class="font-weight-600 nav-link nav-hover py-1 px-2 {% if request.path == '/oglasi/' %} link-secondary {% endif %}">O nama</a>
            </li>
            <li>
              <a href="{% url 'about_us' %}?selected=karijera" class="font-weight-600 nav-link nav-hover py-1 px-2 {% if request.path == '/oglasi/' %} link-secondary {% endif %}">Karijera</a>
            </li>
            <li>
              <a href="{% url 'about_us' %}?selected=pitanja" class="font-weight-600 nav-link nav-hover py-1 px-2 {% if request.path == '/oglasi/' %} link-secondary {% endif %}">Pitanja i odgovori</a>
            </li>
            <li>
              <a href="#" class="font-weight-600 nav-link nav-hover py-1 px-2 {% if request.path == '/oglasi/' %} link-secondary {% endif %}">Pravila i uslovi korišćenja</a>
            </li>
          </ul>
        </li>
        <li class="px-2 "><a href="#" class="nav-link nav-hover border-end {% if request.resolver_match.url_name == 'home' %} text-white border-white {% else %} border-dark-50 {% endif %}" data-bs-toggle="dropdown" aria-expanded="false">
            Jezik
              <ul class="dropdown-menu">
                <li class="d-flex flex-row align-items-center">
                  <img class="mx-1 font-weight-600" width="21" height="19" src="{% static 'images/shared/flag_serbia.png' %}" alt="language flag">Srpski(lat)
                </li>
                <li>
                  <img class="mx-1 font-weight-600" width="21" height="19" src="{% static 'images/shared/flag_serbia.png' %}" alt="language flag">Српски(Ћир)
                </li>
                <li>
                  <img class="mx-1 font-weight-600" width="20" height="18" src="{% static 'images/shared/flag_bosnia.png' %}" alt="language flag">Bosanski(lat)
                </li>
              </ul>
          </a>
        </li>
      </ul>
      {% if user.id is not None %}
        <div class="dropdown text-end">
          <a href="#" class="d-block link-light text-decoration-none dropdown-toggle"
            data-bs-toggle="dropdown" aria-expanded="false">
            <img src="https://github.com/mdo.png" alt="mdo" width="32" height="32"
                class="rounded-circle ms-2">
          </a>
          <ul class="dropdown-menu text-small">
            <li><a class="dropdown-item" href="{% url 'listing_create' %}">Postavi oglas</a></li>
            <!-- <li><a class="dropdown-item" href="{% url 'listing_settings' %}">Podesavanja</a></li> -->
            <li>
              <hr class="dropdown-divider">
            </li>
            <li><a class="dropdown-item" href="{% url 'logout' %}">Odjava</a></li>
          </ul>
        </div>
        {% else %}
          {% include 'account_pages/login_register_modal.html' %}
        {% endif %}
      </div>
    <div class="col-2 p-0">
      <a style="width: 131px;" {% if user.id is not None %} href="{% url 'listing_create' %}" {% else %} data-bs-toggle="modal" data-bs-target="#accountModal" {% endif %}  class="btn create-listing-btn">+ Postavi Oglas</a>
    </div>
  </div>
</div>

{% if request.path != '/'%}
  <div class="container-fluid border-bottom"></div>
{% endif %}
<script>


async function populateSubCategories() {
  try {
    const response = await fetch(`/oglasi/get-all-categories`);
    const json = await response.json();

    const subcategorySelect = document.getElementById('subCategories');

    json.forEach(parentCat => {
  let childOptions = parentCat.children.map(childCat => {
    return `<li><a class="font-weight-600 nav-link nav-hover py-1 px-2 {% if request.resolver_match.url_name == '' %} link-secondary {% endif %}"" href="{% url 'listings' %}?tip=${childCat.name}">${childCat.name}</a></li>`;
  }).join('');
  subcategorySelect.innerHTML += 
    `<li class="dropdown-submenu">
      <a class="font-weight-600 nav-link nav-hover py-1 px-2 {% if request.resolver_match.url_name == '' %} link-secondary {% endif %}"" href="{% url 'listings' %}?tip=${parentCat.name}">${parentCat.name} > </a>
      <ul class="dropdown-menu">
        ${childOptions}
      </ul>
    </li>`;
});
  } catch (error) {
    console.error(error);
  }
  
}  
populateSubCategories()
</script>
