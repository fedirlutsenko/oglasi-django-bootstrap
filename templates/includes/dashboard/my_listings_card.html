{% load static %}

<div class="d-flex border-bottom  border-secondary mt-3" >
  <div class="col-4 d-flex">
    <div class="position-absolute p-1 rounded text-white {% if listing.status == '0' %} bg-danger {% elif listing.status == '1' %} bg-secondary {% endif %}">
      {% if listing.status == '0' %}
        Prodaja
      {% elif listing.status == '1' %}
        Izdavanje
      {% endif %}
    </div>
    <img class="rounded" src='{% get_media_prefix %}{{ listing.images.first.file }}' alt="Hearth" width="180px" height="102px" onclick="onListingClick('{{listing.slug}}')">
    <div class="ps-3">
      <p class="fw-bold">{{listing.title|truncatechars:25}}</p>
      <p class="d-flex">{{listing.city}}, {{listing.municipality}}</p>
      <h6 class="fw-bold">{% include 'includes/listing_helpers/price_parser.html' %}</h6>
    </div>
  </div>
  <div class="col-2 d-flex justify-content-center align-items-center fw-light" >
      {{listing.date_listed|date:"d"}}.{{listing.date_listed|date:"m"}}.{{listing.date_listed|date:"Y"}}
  </div>
  <div class="col-2 d-flex justify-content-center align-items-center">  
    <div class="rounded py-2 px-4 color-blue border border-info ">
      {{listing.status}}
    </div> 
  </div>
  <div class="col-2 d-flex justify-content-center align-items-center">
      2321
  </div>
  <div class="col-2 d-flex justify-content-evenly align-items-center">
    <form method='POST' action="{% url 'edit' %}">
      {% csrf_token %}
      <button type="submit" class="border-0 bg-white">
        <input type="hidden" name="_method" value="EDIT">
        <img src="{% static 'images/icons/edit.svg' %}" alt="Hearth" width="30px" height="30px">
      </button>
    </form>
    <form method='POST' action="{% url 'delete' listing.id %}">
      {% csrf_token %}
      <button type="submit" class="border-0 bg-white">
        <input type="hidden" name="_method" value="DELETE">
        <img src="{% static 'images/icons/bin.svg' %}" alt="Hearth" width="28px" height="28px"/>
      </button>
      </form>
  </div>
</div>
<script>

// save scroll position before refresh page
  window.addEventListener('beforeunload', function () {
    localStorage.setItem('scrollTop', window.pageYOffset);
});

// show saved   position before after page

window.addEventListener('load', function () {
  const scrollTop = localStorage.getItem('scrollTop');
  if (scrollTop) {
      window.scrollTo(0, scrollTop);
  }
});

function onListingClick(slug) {
      {% if debug != None %}
        window.location.href=`http://localhost:8000/oglasi/pregled/${slug}`
      {% else %}
        console.error('Define real URL');
      {% endif %}
  }
</script>